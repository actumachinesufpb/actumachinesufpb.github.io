<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Apostila R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ActuMachines</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Apostila R</h1>

</div>


<div id="introducao-ao-r" class="section level1">
<h1><strong>1.0. Introdução ao R</strong></h1>
<div id="introducao" class="section level2">
<h2><strong>1.1. Introdução</strong></h2>
<p>Neste módulo inicial, iremos fazer uma breve introdução à linguagem R, que é uma linguagem de programação vetorizada, muito utilizada para análise de dados.</p>
</div>
<div id="conceitos-iniciais" class="section level2">
<h2><strong>1.2. Conceitos iniciais</strong></h2>
<div id="utilizando-o-r-como-calculadora" class="section level4">
<h4><strong>1.2.1 Utilizando o R como calculadora</strong></h4>
<p>o R é capaz de fazer operações básicas matemáticas de forma bastante simples, basta digitar a operação de forma intuitiva.</p>
<ul>
<li><p>Operações básicas:</p></li>
<li><p>Soma:</p>
<pre class="r"><code>  2 + 2</code></pre>
<pre><code>## [1] 4</code></pre></li>
<li><p>Subtração:</p>
<pre class="r"><code>  20 - 10</code></pre>
<pre><code>## [1] 10</code></pre></li>
<li><p>Multiplicação:</p>
<pre class="r"><code>74673 * 28380</code></pre>
<pre><code>## [1] 2119219740</code></pre></li>
<li><p>Divisão:</p>
<pre class="r"><code>293 / 7</code></pre>
<pre><code>## [1] 41.85714</code></pre></li>
<li><p>Divisão exata:</p>
<pre class="r"><code>293 %/% 7</code></pre>
<pre><code>## [1] 41</code></pre></li>
<li><p>Resto da divisão:</p>
<pre class="r"><code>293 %% 7</code></pre>
<pre><code>## [1] 6</code></pre></li>
</ul>
</div>
<div id="criando-vetores-e-matrizes" class="section level4">
<h4><strong>1.2.2 Criando Vetores e Matrizes</strong></h4>
<p>A menor estrutura de dados que o R entende é um vetor, e o que foi feito na seção anterior consistiu na criação de um vetor de um elemento, mas e se quisermos criar um vetor com mais de um elemento? Para isso, iremos utilizar a função <code>c()</code> que serve para concatenar os objetos na criação de um vetor.</p>
<p>Suponha que você queira declarar um vetor com cinco elementos: 30, 50, 70, 80, 90. Como devo proceder para criar um vetor, então?</p>
<p>Basta utilizar a função <code>c()</code> e como temos cinco argumentos, separa-se cada elemento por vírgulas.</p>
<pre class="r"><code>c(30, 50, 70, 80, 90)</code></pre>
<pre><code>## [1] 30 50 70 80 90</code></pre>
<p>Certo, criamos o nosso primeiro vetor, mas, nas nossas análises, precisamos de praticidade, e, do jeito que o vetor foi criado, não é nenhum pouco prático.</p>
<p>Precisamos criar uma variável que contenha o vetor. Essa nossa variável pode possuir qualquer nome, e como queremos que ela contenha o vetor que acabamos de criar, basta declarar uma variável para o vetor que criamos. Vamos chamar a variável de <code>Despesas</code>.</p>
<pre class="r"><code>Despesas &lt;- c(30, 50, 70, 80, 90)</code></pre>
<p>Agora, se quisermos ver o nosso vetor, digite o nome da variável criada e então o vetor contendo os cinco elementos irá aparecer.</p>
<pre class="r"><code>Despesas</code></pre>
<pre><code>## [1] 30 50 70 80 90</code></pre>
<p>Vamos supor que tenhamos uma nova informação, que contenha as nossas receitas nos cinco primeiros meses do ano:</p>
<pre class="r"><code>Receitas &lt;- c(100, 90, 30, 40, 120)
Receitas</code></pre>
<pre><code>## [1] 100  90  30  40 120</code></pre>
<p>Agora que temos dois vetores, o de receitas e as despesas, como podemos fazer para uní-los? Simples! Utilizaremos uma função chamada <code>cbind()</code> que serve para juntar dois ou mais vetores, em duas ou mais colunas lado-a-lado, como uma tabela.</p>
<pre class="r"><code>ReceitasXdespesas &lt;- cbind(Receitas, Despesas)
ReceitasXdespesas</code></pre>
<pre><code>##      Receitas Despesas
## [1,]      100       30
## [2,]       90       50
## [3,]       30       70
## [4,]       40       80
## [5,]      120       90</code></pre>
<p>Certo, temos uma tabela com duas colunas, demonstrando as receitas e as despesas durante cinco meses, porém não temos nenhum nome para as linhas da nossa tabela. Então, para facilitar nossas vidas vamos deixar a tabela atrativa visualmente, nomeando cada linha dela.</p>
<p>Antes de mudarmos os nomes das linhas, seria mais interessante declaramos uma variável contendo os nomes dos meses (representando os nomes das linhas). Segue o mesmo processo de criação de uma variável numérica, mas com uma diferença de que é necessário colocar aspas (“”) em cada mês, por se tratar de uma variável <em>string</em>.</p>
<pre class="r"><code>names &lt;- c(&quot;Janeiro&quot;, &quot;Fevereiro&quot;, &quot;Março&quot;, &quot;Abril&quot;, &quot;Maio&quot;)
names</code></pre>
<pre><code>## [1] &quot;Janeiro&quot;   &quot;Fevereiro&quot; &quot;Março&quot;     &quot;Abril&quot;     &quot;Maio&quot;</code></pre>
<p>Agora que temos os meses necessários, podemos declarar o nome das linhas de nossa tabela.</p>
<pre class="r"><code>rownames(ReceitasXdespesas) &lt;- names
ReceitasXdespesas</code></pre>
<pre><code>##           Receitas Despesas
## Janeiro        100       30
## Fevereiro       90       50
## Março           30       70
## Abril           40       80
## Maio           120       90</code></pre>
<p>Temos, portanto, uma tabela organizada com os valores das <code>Receitas</code> e <code>Despesas</code> e os meses. Suponha, agora que a pessoa queira ver seu resultado entre as receitas e as despesas de cada mês? Basta subtrair as receitas com as despesas.</p>
<pre class="r"><code>Balanco &lt;- Receitas - Despesas</code></pre>
<p>Unindo tudo, temos:</p>
<pre class="r"><code>Total &lt;- cbind(ReceitasXdespesas, Balanco)
Total</code></pre>
<pre><code>##           Receitas Despesas Balanco
## Janeiro        100       30      70
## Fevereiro       90       50      40
## Março           30       70     -40
## Abril           40       80     -40
## Maio           120       90      30</code></pre>
<p>Agora que temos as receitas e despesas de cada mês, se quisermos observar o resultado do mês de abril, como faremos? Basta por colchetes <code>[]</code> no final da variável Total, e com isso selecionar a quarta linha e a terceira coluna, ou identificar qual a linha e a coluna por nome entre colchete.</p>
<pre class="r"><code>Total[4, 3]</code></pre>
<pre><code>## [1] -40</code></pre>
<pre class="r"><code>Total[&quot;Abril&quot;, &quot;Balanco&quot;]</code></pre>
<pre><code>## [1] -40</code></pre>
<p>Com isso, temos a localização exata de um objeto da matriz.</p>
</div>
<div id="data-frame" class="section level4">
<h4><strong>1.2.3 Data Frame</strong></h4>
<p>Nesta seção, iremos falar sobre dataframes que são listas de variáveis com o mesmo número de linhas.</p>
<p>Vamos utilizar a matriz que utilizamos anteriormente, <code>Total</code>. Iremos verificar se é um dataframe. Vamos utilizar a função <code>class()</code>, que serve para analisar a classe do objeto em questão.</p>
<pre class="r"><code>class(Total)</code></pre>
<pre><code>## [1] &quot;matrix&quot;</code></pre>
<p>Como podemos observar, a tabela que construímos anteriormente é uma matriz e como analista de dados, às vezes, precisamos utiilzar uma função em um conjunto de dados, o que só seria possível em um data frame na linguagem R. Portanto, como transformar nossa matriz num dataframe? Basta utilizar a função <code>data.frame()</code>.</p>
<pre class="r"><code>df &lt;- data.frame(Total)
df</code></pre>
<pre><code>##           Receitas Despesas Balanco
## Janeiro        100       30      70
## Fevereiro       90       50      40
## Março           30       70     -40
## Abril           40       80     -40
## Maio           120       90      30</code></pre>
<p>Agora, se quisermos manipular o dataframe, como por exemplo, excluir duas colunas.</p>
<p>É simples! Primeiro, temos que aprender a acessar uma coluna do dataframe, que se dá por meio do símbolo <code>$</code>. Exemplo: acessar somente as receitas:</p>
<pre class="r"><code>df$Receitas</code></pre>
<pre><code>## [1] 100  90  30  40 120</code></pre>
<p>Supondo que uma pessoa queira visualizar as receitas do mês de março apenas, como deve ser feito? Igual a uma matriz. Ao invés de separar por vírgulas, iremos juntar os dois colocando o <em>dollar sign</em> e os colchetes:</p>
<pre class="r"><code>df$Receitas[3]</code></pre>
<pre><code>## [1] 30</code></pre>
<p>Voltando para o questionamento anterior, como remover uma coluna do dataframe? Basta repetir o processo anterior e declarar <code>NULL</code></p>
<pre class="r"><code>df$Receitas &lt;- NULL
df$Despesas &lt;- NULL
df</code></pre>
<pre><code>##           Balanco
## Janeiro        70
## Fevereiro      40
## Março         -40
## Abril         -40
## Maio           30</code></pre>
<p>Dessa forma, temos nosso dataframe completo, apenas com o resultado final do balanço.</p>
<p>Se quisermos filtrar apenas os meses com balanço positivo, como fazer de uma maneira simples?</p>
<pre class="r"><code>df[df$Balanco&gt;0,]</code></pre>
<pre><code>## [1] 70 40 30</code></pre>
</div>
</div>
</div>
<div id="rmarkdown" class="section level1">
<h1><strong>2.0 RMarkdown</strong></h1>
<div id="cabecalho-no-r-markdown" class="section level2">
<h2><strong>2.1. Cabeçalho no R Markdown</strong></h2>
<p>Para fazer um cabeçalho no R Markdown, utilize o símbolo *.</p>
<p>OBS: É conviniente pular uma linha para cada escrita do texto para cada formato desejado.</p>
<div id="italico-e-negrito" class="section level3">
<h3>2.2 Itálico e Negrito</h3>
<p>*= <em>itálico</em></p>
<p>**= <strong>Negrito</strong></p>
<p>A <strong>Base de dados</strong> que iremos utilizar será a <em>mtcars</em>, que é uma base de dados que vem com a instalação do RStudio.</p>
<div id="exemplo" class="section level4">
<h4>2.2.1 Exemplo:</h4>
<p>'= <code>deixar comando como código</code></p>
</div>
</div>
</div>
</div>
<div id="listas" class="section level1">
<h1><strong>2.3 Listas</strong></h1>
<div id="lista-ordenada" class="section level3">
<h3><strong>2.3.1 Lista ordenada</strong></h3>
<ol style="list-style-type: decimal">
<li>Filipe</li>
<li>Igor</li>
<li>Victor</li>
<li>Nathan</li>
<li>Manu</li>
</ol>
</div>
<div id="lista-nao-ordenada" class="section level3">
<h3><strong>2.3.2 Lista não ordenada</strong></h3>
<ul>
<li>Filipe</li>
<li>Igor</li>
<li>Victor</li>
<li>Nathan</li>
<li>Manu</li>
</ul>
</div>
<div id="criando-links-no-markdown" class="section level3">
<h3><strong>2.4 Criando Links no Markdown</strong></h3>
<p>Para baixar qualquer arquivo de aula, etc., é só acessar o menu <a href="https://github.com/Zurubabel/RMarkdown">Github</a>. Entre [ ] coloque o texto e ( )insere o link.</p>
</div>
<div id="criando-formulas-matematicas" class="section level2">
<h2><strong>2.5. Criando fórmulas matemáticas</strong></h2>
<p>Para escrevermos as funções matemáticas, teremos que ter um conhecimento básico de LaTeX, já que esse tipo de linguagem é nativamente feita para a produção científica.</p>
<div id="introducao-ao-latex" class="section level3">
<h3><strong>2.5.1. Introdução ao LaTeX</strong></h3>
<p>Como dito anteriormente, para escrevermos equações e funções matemáticas no R, temos que utilizar o LaTeX, para isso, iremos ter em mente um breve resumo sobre a linguagem:</p>
<p><span class="math display">\[ X^{2} \]</span></p>
</div>
<div id="exemplos" class="section level3">
<h3><strong>2.5.1.2 Exemplos</strong></h3>
<div id="razao-e-fracao-ab" class="section level4">
<h4>5.1.1 Razão e fração a/b</h4>
<p><span class="math display">\[ \sqrt{\frac{a}{b}} \]</span></p>
</div>
</div>
<div id="regressao-linear" class="section level3">
<h3><strong>2.5.1.3 Regressão Linear</strong></h3>
<p><span class="math display">\[ y = \alpha +\beta_{1}X_{1}+e \]</span></p>
</div>
<div id="bloco-de-codigos" class="section level3">
<h3><strong>2.6.Bloco de Códigos</strong></h3>
<p>Podemos criar blocos inline ou em bloco.</p>
<pre class="r"><code>x&lt;- c(&quot;zurubabel&quot;)

str(mtcars)</code></pre>
<pre><code>## &#39;data.frame&#39;:    32 obs. of  11 variables:
##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp: num  160 160 108 258 360 ...
##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec: num  16.5 17 18.6 19.4 17 ...
##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</code></pre>
</div>
<div id="inline" class="section level3">
<h3>Inline</h3>
<p><code>rx[1]</code></p>
</div>
<div id="flags-do-bloco-de-codigo" class="section level3">
<h3><strong>7.Flags do Bloco de código</strong></h3>
</div>
</div>
<div id="flags" class="section level2">
<h2>Flags</h2>
<div id="eval" class="section level3">
<h3>Eval</h3>
<p>O <code>eval</code> habilita ou não a execução do código, utilizando <code>eval= FALSE</code> o código não será executado e possíveis valores não serão armazenados.</p>
<pre class="r"><code>str(x&lt;-&quot;Churros&quot;)</code></pre>
<pre><code>##  chr &quot;Churros&quot;</code></pre>
</div>
<div id="echo" class="section level3">
<h3>echo</h3>
<p>O echo mostra o código junto ao resultado.</p>
<pre class="r"><code>str(mtcars)</code></pre>
<pre><code>## &#39;data.frame&#39;:    32 obs. of  11 variables:
##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp: num  160 160 108 258 360 ...
##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec: num  16.5 17 18.6 19.4 17 ...
##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</code></pre>
</div>
<div id="warning" class="section level3">
<h3>Warning</h3>
<p>O <code>Warning</code> exibe as possíveis advertêcias no código</p>
<pre class="r"><code> warning(&quot;Será que o resultado é esse mesmo?&quot;)</code></pre>
<pre><code>## Warning: Será que o resultado é esse mesmo?</code></pre>
</div>
<div id="error" class="section level3">
<h3>Error</h3>
<p>O <code>error</code> tem a função de ocultar ou não as mensagens de erro do seu código. Se for <code>FALSE</code> também não deixa de executar o código</p>
</div>
<div id="gerando-documentos-em-outros-formatos" class="section level3">
<h3><strong>2.8. Gerando documentos em outros formatos</strong></h3>
<p>Para gerar documentos em PDFS, PPTs, HTML, word, basta inserir o tipo de dado no <code>output</code>, no bloco inicial do documento.</p>
<div id="possiveis-conversoes" class="section level4">
<h4><strong>2.8.1 Possíveis conversões</strong></h4>
<ul>
<li><code>html_document</code></li>
<li><code>pdf_document</code> - Se não fucionar, baixe e instale o pacote <a href="https://miktek.org/2.9/setup">MikTek</a></li>
<li><code>word_document</code></li>
<li><code>beamer_presentation</code></li>
<li><code>slidy_presentation</code></li>
<li><code>ioslides_presentation</code></li>
</ul>
</div>
<div id="opcoes-de-tabelas" class="section level4">
<h4><strong>2.9 Opções de tabelas</strong></h4>
<p>Existem diversos pacotes no <code>R</code> que interagem com o <code>Rmarkdown</code> para fazer tabelas.</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/xtable/">xtable</a></li>
<li><a href="https://cran.r-project.org/web/packages/stargazer/">stargazer</a></li>
<li><a href="https://rapporter.github.io/pander/">pander</a></li>
<li><a href="https://cran.r-project.org/web/packages/tables/">tables</a></li>
<li><a href="https://eusebe.github.io/ascii/">ascii</a></li>
<li>etc.</li>
</ul>
<p>É fácil utilizá-los com o pacote <code>knitr</code>, função <code>kable</code>:</p>
<pre class="r"><code>library(knitr)
kable(mtcars[1:5, ], caption = &quot;Tabela com knitr&quot;)</code></pre>
<table>
<caption>Tabela com knitr</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="introducao-ao-pacote-ggplot2" class="section level1">
<h1><strong>3.0. Introdução ao pacote ggplot2()</strong></h1>
<div id="base-de-dados-mtcars" class="section level2">
<h2><strong>3.1. Base de dados (mtcars)</strong></h2>
<p>Os dados foram extraídos da revista Motor Trend nos Estados Unidos de 1974 e compreendem o consumo de combustível e 10 aspectos do projeto e desempenho de 32 automóveis (modelos 1973-1974).</p>
</div>
<div id="formato-dos-dados-mtcars" class="section level2">
<h2><strong>Formato dos dados (mtcars)</strong></h2>
<p>Os dados estão estruturados em um <em>data frame</em> contendo 32 observações e 11 variáveis.</p>
</div>
<div id="nome-dos-dados-mtcars" class="section level2">
<h2><strong>3.1.1 Nome dos dados (mtcars)</strong></h2>
<pre class="r"><code>names(mtcars)</code></pre>
<pre><code>##  [1] &quot;mpg&quot;  &quot;cyl&quot;  &quot;disp&quot; &quot;hp&quot;   &quot;drat&quot; &quot;wt&quot;   &quot;qsec&quot; &quot;vs&quot;   &quot;am&quot;   &quot;gear&quot;
## [11] &quot;carb&quot;</code></pre>
<div id="significado-de-cada-variavel" class="section level3">
<h3><strong>3.1.2. Significado de cada variável</strong></h3>
<ul>
<li><p><code>mpg</code> - milhas de mpg / galão (EUA).</p></li>
<li><p><code>cyl</code> - Número de cilindros</p></li>
<li><p><code>disp</code> - Displacement (cu.in.)</p></li>
<li><p><code>hp</code> - Potência bruta</p></li>
<li><p><code>drat</code> - Relação do eixo traseiro</p></li>
<li><p><code>wt</code> - peso - (1000 lbs)</p></li>
<li><p><code>qsec</code> - 1/4 milha hora</p></li>
<li><p><code>vs</code> - Motor (0 = em forma de V, 1 = direito)</p></li>
<li><p><code>am</code> - Transmissão (0 = automático, 1 = manual)</p></li>
<li><p><code>gear</code> - Número de marchas para frente</p></li>
<li><p><code>carb</code> - Número de carburadores</p></li>
</ul>
</div>
<div id="visualizacao-dos-dados" class="section level3">
<h3><strong>3.1.3. Visualização dos dados</strong></h3>
<p>A visualização dos dados faz parte da análise exploratória, uma etapa muito importante na <strong>análise estatística</strong>, pois a partir dela criamos a intuição para escolher o modelo mais adequado para o nosso problema.</p>
<p>Visualizações podem ser <strong>medidas resumo</strong> (frequência, média, variância, mínimo, máximo, etc.) um conjunto de medidas organizadas em uma tabela, ou a representação (de uma parte) dos dados em um gráfico.</p>
<p>Portanto, nesta aula <strong>focaremos na construção de gráficos</strong>. É um processo que <strong>facilita a visualização dos dados</strong> construídos por ferramentas disponíveis no R.</p>
</div>
</div>
<div id="o-que-e-um-grafico" class="section level2">
<h2><strong>3.2. O que é um gráfico?</strong></h2>
<p>A construção de gráficos no R foi revolucionada com a criação do pacote <code>ggplot2</code>, proveniente da tese de doutorado de Hadley Wickham que apresentou um novo modelo de apresentação e criação de gráficos na linguagem R.</p>
<div id="vantagens-do-pacote-ggplot2" class="section level3">
<h3><strong>3.2.1. Vantagens do pacote ggplot2</strong></h3>
<p>Existem inúmeras vantagens, dentre elas:</p>
<ul>
<li><p>Gráficos naturalmente mais estéticos;</p></li>
<li><p>Maior acessibilidade de ajustar os gráficos do jeito que desejar;</p></li>
<li><p>Estrutura padronizada das funções para aprender com maior interação;</p></li>
<li><p>Possibilidade de criar uma imensa gama de gráficos com poucas linhas de código.</p></li>
</ul>
</div>
<div id="comando-para-instalacao-do-pacote-ggplot2" class="section level3">
<h3><strong>3.2.2. Comando para instalação do pacote (ggplot2)</strong></h3>
<p>Utiliza-se o comando <code>install.packages(&quot;ggplot2&quot;)</code> para instalar e, para carregar o pacote, usa-se:</p>
<pre class="r"><code>library(ggplot2)</code></pre>
</div>
<div id="camadas-de-um-grafico" class="section level3">
<h3><strong>3.2.3. Camadas de um gráfico</strong></h3>
<p>No <strong>ggplot2</strong>, os gráficos são construídos camada por camada (ou por <em>layers</em>, em inglês), sendo a primeira delas dada pela função <code>ggplot()</code> (repare que não usa-se o <code>2</code>). Essa função recebe um <em>data frame</em> e cria a camada base do gráfico. Se rodarmos apenas a função <code>ggplot()</code>, obteremos um painel em branco.</p>
<p>Vamos agora fazer o primeiro gráfico de dispersão:</p>
<pre class="r"><code>ggplot(data = mtcars) + 
  geom_point(mapping = aes(x = disp, y = mpg))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>A figura gerada pelo código acima é um gráfico de dispersão. Observe que:</p>
<ul>
<li><p>como vimos, a primeira camada é dada pela função <strong>ggplot()</strong> e recebe um <em>data frame</em>;</p></li>
<li><p>a segunda camada é dada pela função <strong>geom_point()</strong>, que especifica a forma geométrica utilizada no mapeamento das observações;</p></li>
<li><p>as camadas são somadas com um <code>+</code>;</p></li>
<li><p>o mapeamento na função <strong>geom_point()</strong> recebe a função <strong>aes()</strong>, que é responsével por descrever como as variáveis serão mapeadas nos aspectos visuais da forma geométrica escolhida, no caso, pontos.</p></li>
</ul>
<p>A combinação da função <strong>ggplot()</strong> e de uma ou mais funções <strong>geom_()</strong> definirá o tipo de gráfico gerado.</p>
<p>Podemos acrescentar uma terceira camada ao gráfico, agora com uma personalizão. Repare como é simples acrescentar labels ao gráfico com a função <strong>labs()</strong>.</p>
<pre class="r"><code>ggplot(data = mtcars) + geom_point(mapping = aes(x = disp, y = mpg)) +
  labs(x = &quot;Cilindradas&quot;, y = &quot;Milhas/galão&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
</div>
<div id="aesthetics" class="section level2">
<h2><strong>3.3. Aesthetics</strong></h2>
<p>O papel da função aes() (de aesthetics, estética em inglês) é indicar a relação entre os dados e cada aspecto visual do gráfico, como qual variével será representada no eixo x, qual será representada no eixo y, a cor e o tamanho dos componentes geométricos, etc. Os aspectos que podem ou devem ser mapeados dependem do tipo de gráfico que você está construindo.</p>
<p>Outro aspecto que pode ser mapeado nesse gráfico é a cor dos pontos:</p>
<pre class="r"><code>ggplot(data = mtcars) + 
  geom_point(mapping = aes(x = disp, y = mpg, color = as.factor(am)))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Agora, a variável <code>am</code> (tipo de transmissão) foi mapeada em relação a cor dos pontos com pontos vermelhos correspondendo à transmissão automática (valor 0), e pontos azuis à transmissão manual (valor 1). Observe que inserimos a variável <code>am</code> como um fator, pois temos interesse apenas nos valores <code>0</code> e <code>1</code>. No entanto, também podemos mapear uma variável contínua em relação à cor dos pontos:</p>
<pre class="r"><code>ggplot(mtcars) + 
  geom_point(mapping = aes(x = disp, y = mpg, colour = cyl))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>Aqui, o número de cilindros, <code>cyl</code>, é representado pela tonalidade da cor azul. Note que, por padrão, a legenda é inserida automaticamente ao gráfico. É possível, também, mapear o tamanho dos pontos em uma variável de interesse:</p>
<pre class="r"><code>ggplot(mtcars) +
  geom_point(mapping = aes(x = disp, y = mpg, color = cyl, size = wt))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Segue abaixo uma lista dos aspectos visuais mais utilizados:</p>
<p><strong>color</strong>=: altera a cor de formas que não têm área (pontos e retas). <strong>fill</strong>=: altera a cor de formas com área (barras, caixas, densidades, áreas). <strong>size</strong>=: altera o tamanho de formas. <strong>type</strong>=: altera o tipo da forma, geralmente usada para pontos. <strong>linetype</strong>=: altera o tipo da linha.</p>
<p>Até agora, sempre mapeamos um aspecto estético relacionado a uma variável. Muitas vezes queremos apenas modificar um aspecto sem mapeá-lo atrelados a variáveis. Por exemplo, no gráfico a seguir, modificamos a cor de todos os pontos.</p>
<pre class="r"><code>ggplot(mtcars, aes(y = mpg, x = disp)) + 
  geom_point(color = &quot;red&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>A principal diferença aqui reside na especificação do argumento <code>color =</code> fora da função <code>aes()</code>. Dessa forma, podemos controlar todos os aspectos de uma forma geom?trica.</p>
<pre class="r"><code>ggplot(mtcars, aes(y = mpg, x = disp)) + 
  geom_point(color = &quot;red&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>A principal diferença aqui é que especificamos o argumento <code>color =</code> fora da função <code>aes()</code>. Dessa forma, podemos controlar todos os aspectos de uma forma geométrica.</p>
<pre class="r"><code>ggplot(mtcars, aes(y = mpg, x = disp)) + 
  geom_point(colour = &quot;red&quot;, size = 2, shape = 3, alpha = 0.5)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="geoms" class="section level2">
<h2><strong>3.4. Geoms</strong></h2>
<p>Os <code>geoms</code> definem qual forma geométrica será utilizada para a visualização das observações. Como vimos previamente, a função <code>geom_point()</code> gera gráficos de dispersão transformando pares (x,y) em pontos. Veja a seguir outros geoms bastante utilizados:</p>
<p>-<strong>geom_line</strong> - para linhas definidas por pares (x,y). -<strong>geom_abline</strong> - para retas definidas por um intercepto e uma inclinação. -<strong>geom_hline</strong> - para retas horizontais. -<strong>geom_bar</strong> - para barras. -<strong>geom_histogram</strong> - para histogramas. -<strong>geom_boxplot</strong> - para boxplots. -<strong>geom_density</strong> - para densidades. -<strong>geom_area</strong> - para áreas.</p>
<p>Veja a seguir como é fácil gerar diversos gráficos utilizando a mesma estrutura do gráfico de dispersão acima como o bloxpot:</p>
<pre class="r"><code>ggplot(mtcars) + 
  geom_boxplot(aes(x = as.factor(cyl), y = mpg))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Note que para fazer um boxplot para cada grupo, precisamos passar um fator para o aspecto <code>x</code> do gráfico.</p>
<pre class="r"><code>ggplot(mtcars) + 
  geom_histogram(aes(x = mpg))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
</div>
<div id="regressao-linear-1" class="section level1">
<h1><strong>4.0. Regressão linear</strong></h1>
<p>A regressão linear é um método estatístico utilizado para verificar se alguma variável da amostra <strong>(independente)</strong> se associa a outra variável <strong>(dependente)</strong>, e, se isso se verificar, em qual direção, positiva ou negativa. Essa associação é observada pelo coeficiente angular (<span class="math inline">\(\beta\)</span>) da regressão que iremos estimar.</p>
<pre><code>Fórmula da regressão linear:</code></pre>
<p><span class="math display">\[Y = \alpha + \beta*X +  \epsilon\]</span> Aplicando no R, usaremos a base de dados mtcars, que já vem na própria linguagem. Queremos observar se a variável <code>hp</code> (independente), têm alguma influência na <code>mpg</code> (dependente):</p>
<p><span class="math display">\[mpg = \alpha + \beta*hp + \mu \]</span></p>
<p>Para fazer a regressão no R, usaremos o seguinte comando:</p>
<pre><code>lm(formula, data, subset)</code></pre>
<ul>
<li>Significado de cada argumento da função lm:
<ul>
<li>função lm: significa <em>linear model</em>, ou seja, o modelo que queremos utilizar;</li>
<li>formula: Fórmula que será utilizada para a regressão;</li>
<li>data: base de dados que iremos utilizar no modelo;</li>
<li>subset: sub-amostra da base de dados que iremos utilizar;</li>
</ul></li>
</ul>
<p>Como queremos explicar mpg através de hp, a fórmula será o seguinte:</p>
<pre class="r"><code>reg1 &lt;- lm(mpg ~ hp, data = mtcars)
reg1</code></pre>
<pre><code>## 
## Call:
## lm(formula = mpg ~ hp, data = mtcars)
## 
## Coefficients:
## (Intercept)           hp  
##    30.09886     -0.06823</code></pre>
<p>Observando o coeficiente da regressão, podemos ver que o coeficiente da variável independente é negativo com relação à dependente.</p>
<p>Utilizando a função <code>summary()</code> que serve para dar um sumário do objeto que colocaremos como input na função.</p>
<pre class="r"><code>summary(reg1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mpg ~ hp, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7121 -2.1122 -0.8854  1.5819  8.2360 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.09886    1.63392  18.421  &lt; 2e-16 ***
## hp          -0.06823    0.01012  -6.742 1.79e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.863 on 30 degrees of freedom
## Multiple R-squared:  0.6024, Adjusted R-squared:  0.5892 
## F-statistic: 45.46 on 1 and 30 DF,  p-value: 1.788e-07</code></pre>
<p>Obseravndo o sumário da regressão, podemos observar que há uma forte significância da variável <code>horse power</code> sobre a <code>mpg</code>, e, observando a primeira coluna, podemos ver que o coeficiente é negativo, ou seja, conclui-se que, para a amostra em questão, quanto maior a força do motor, menos milhas por galão são feitas.</p>
<div id="graficos" class="section level2">
<h2><strong>4.2. Gráficos</strong></h2>
<div id="grafico-de-dispersao" class="section level3">
<h3><strong>4.2.1. Gráfico de dispersão</strong></h3>
<p>Queremos observar pontualmente como as variáveis escolhidas se comportam.</p>
<p>Iremos utilizar o pacote ggplot2, para relembrar, deve-se instalá-lo através do comando <strong>install.packages()</strong> e logo então carregá-lo através do comando <strong>library()</strong>:</p>
<pre><code>install.packages(&quot;ggplot2&quot;)
library(ggplot2)</code></pre>
<p>Tendo carregado os pré-requisitos, podemos fazer o gráfico de dispersão das variáveis, ou seja, observar se há lineariedade ou não nas variáveis através dos seguintes comandos:</p>
<pre><code>ggplot(data = mtcars) + geom_point(mapping = aes(x = hp, y = mpg))</code></pre>
<ul>
<li>Significado das funções e de cada argumento:</li>
<li>ggplot(): serve para selecionar o objeto que contém o os objetos a serem plotados;
<ul>
<li>data: argumento para selecionar a base de dados do objeto a ser plotado;</li>
</ul></li>
<li>geom_point(): função que determina a geometria do gráfico, no caso, de dispersão;
<ul>
<li>mapping: argumento para determinar os objetos a serem rastreados;</li>
<li>aes(): função para determinar as variáveis do dataframe;</li>
</ul></li>
</ul>
<pre class="r"><code>library(ggplot2)
ggplot(data = mtcars) + geom_point(mapping = aes(x = hp, y = mpg))</code></pre>
<p><img src="index_files/figure-html/pressure-1.png" width="672" /></p>
<p>Podemos visualizar que a dispersão entre essas duas variáveis é praticamente linear. Podemos corroborar esse achado com o modelo de regressão.</p>
</div>
</div>
<div id="observando-a-reta-da-regressao" class="section level2">
<h2><strong>4.2.2 Observando a reta da regressão</strong></h2>
<p>Após a visualização de forma pontual, queremos observar a reta da regressão entre as duas variáveis, para ver se de fato a regressão se confirma, e observar também se há significância estatística. Utilizaremos o seguinte comando:</p>
<pre><code>ggplot(data = mtcars) + geom_smooth(mapping = aes(x = hp, y = mpg), method = &quot;lm&quot;)</code></pre>
<p>O que difere do comando anterior, é que, como queremos uma linha reta teremos que utilizar a função <code>geom_smooth()</code> que serve para visualizar uma reta, diferentemente do anterior, utilizaremos um método para isso, o linear model. Para ver como a reta se comporta com a regressão.</p>
<pre class="r"><code>ggplot(data = mtcars) +geom_smooth(mapping = aes(x = hp, y = mpg), method = &quot;lm&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-42-1.png" width="672" /> Mais uma vez, podemos confirmar a relação negativa entre as duas variáveis ## Plotando os gráficos em apenas um só</p>
<p>Agora, se quisermos unir os dois gráficos, basta colocarmos um <code>+</code> entre os dois códigos ou seja, queremos unir o gráfico de dispersão, com o gráfico da reta da regressão. Basta utilizar os mesmos códigos, apenas somando-os.</p>
<pre><code>ggplot(data = mtcars) + geom_point(mapping = aes(x = hp, y = mpg))+
  geom_smooth(mapping = aes(x = hp, y = mpg), method = &quot;lm&quot;)
</code></pre>
<p>Visualizando:</p>
<pre class="r"><code>ggplot(data = mtcars) + geom_point(mapping = aes(x = hp, y = mpg))+
  geom_smooth(mapping = aes(x = hp, y = mpg), method = &quot;lm&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
